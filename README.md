<h1>Флудилка бот для бесед в телеграм</h1>

<h3>Изначальной целью создания бота было доработать уже имеющегося, но в процессе работы я понял, что хочу сделать масштабируемого бота на Django и pyTelebotApi, поэтому вот...</h3>

<h2>Собственно, о чем бот</h2>

<pre>Писал я бота для общей беседы студ. организации, чтобы напоминать
нам о др каждого участника. Первоначальный вариант был только
с таким функционалом, но я решил добавить еще гороскопы,
праздники сегодня и регистрацию прям в боте, чтобы
не вносить руками из гугл таблицы и вообще не взаимодействовать
с ними, ведь очень замедляется работа при использовании
парсинга гугл таблиц.</pre>

<h3>Итак, что же получилось...</h3>

<p>Поулчился масштабируемый бот, к которому можно прикрутить новые функции</p>

<p>Ссылка на бота <a href='https://t.me/movement_flood_v2_bot'>тут</a></p>

<p>В плане использования я постарался продумать добавление в разные группы<br>
поэтому можно использовать его, либо отталкиваясь от данного репозитория написать нового</p>

<h3>Как пользоваться</h3>

<pre>В общем-то можно написать /help и получить всю информацию о командах.
Но если вдруг, то...
/help выводит все доступные команды
/help {команда} позволяет узнать как использовать нужную команду
/register {имя} {тег} {дд.мм.гггг} позволяет внести нового пользователя в базу данных
/birthday говорит, у кого сегодня день рождения, либо выводит сообщение, что ни у кого нет
/all_birthdays если вы админ бота, то можете использовать эту команду, чтобы отправить во все чаты одновременно
/astro достает все гороскопы с сайта <a href='https://horo.mail.ru/'>мейла</a>
/astro {знак} выводит гороскоп для конкретного знака
/events выводит какие есть праздники сегодня</pre>

<h2>Установка</h2>
<pre>Я не работал с докер контейнерами, поэтому с установкой бота немного запарно</pre>
<h3>Алгоритм действий</h3>
<ol>
<li>Склонировать репозиторий</li>
<li>Выполнить установку requirements.txt<pre>pip install -r requirements.txt</pre></li>
<li>Добавить файл .env с нужными токенами для django, бота и id админа</li>
<li>Установить ngrok для того, чтобы повесить webhook на наш домен</li>
<li>Вместе с запуском <pre>python manage.py runserver</pre></li>
<li>Запустить ngrok через команду <pre>ngrok http 8000</pre>(или другой порт)</li>
<li>Добавить домен ngrok в разрешенные в settings.py для Django>=4 версии</li>
<li>Вешаем вебхук на домен и должно работать</li>
</ol>
<h3>Но это только для локального сервера</h3>
<p>Если вкратце про установку на сервер:<br>
Необходимо все склонировать туда и провести тот же алгоритм действий, но еще<br>
необходимо настроить crontab для того, чтобы раз в день отправлялись сообщения через скрипт script_for_all_b.py<br>
На локальном сервере для этого придется писать еще один скрипт с отслеживанием сегодняшней даты</p>

<h2>Про доработки</h2>
<p>Собственно, это засунуть все в докер, чтобы не проводить такие манипуляции с установкой,<br>
но также можно еще доработать валидацию данных, ведь мне было лень отслеживать дату регистрации,<br>
поэтому сейчас можно зарегистрироваться хоть на 3000 год. Год вообще нужен, чтобы выводить возраст<br>
вместе с поздравлением</p>
